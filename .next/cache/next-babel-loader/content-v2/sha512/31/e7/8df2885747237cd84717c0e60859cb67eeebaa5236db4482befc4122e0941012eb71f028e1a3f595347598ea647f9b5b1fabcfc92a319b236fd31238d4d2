{"ast":null,"code":"import fs from 'fs';\nimport path from 'path';\n\nfunction handler(req, res) {\n  function buildFeedbackPath() {\n    return path.join(process.cwd(), 'data', 'feedback.json');\n  }\n\n  function extractFeedback(filePath) {\n    const fileData = fs.readFileSync(filePath);\n    const data = JSON.parse(fileData);\n    return data;\n  }\n\n  if (req.method === 'POST') {\n    const name = req.body.name;\n    const email = req.body.email;\n    const feedBackText = req.body.feedback;\n    const newFeedback = {\n      id: new Date().toISOString(),\n      name: name,\n      email: email,\n      feedback: feedBackText\n    }; //数据存储在数据库或者文件当中\n\n    const filePath = buildFeedbackPath();\n    const data = extractFeedback(filePath);\n    data.push(newFeedback);\n    fs.writeFileSync(filePath, JSON.stringify(data));\n    res.status(201).json({\n      message: '保存成功！',\n      feedback: newFeedback\n    });\n  } else {\n    //get请求\n    const filePath = buildFeedbackPath();\n    const data = extractFeedback(filePath);\n    res.status(200).json({\n      feedback: data\n    });\n  }\n}\n\nexport default handler;","map":{"version":3,"sources":["/Users/zion/Desktop/nextjs-course/pages/api/feedback.js"],"names":["fs","path","handler","req","res","buildFeedbackPath","join","process","cwd","extractFeedback","filePath","fileData","readFileSync","data","JSON","parse","method","name","body","email","feedBackText","feedback","newFeedback","id","Date","toISOString","push","writeFileSync","stringify","status","json","message"],"mappings":"AAAA,OAAOA,EAAP,MAAe,IAAf;AACA,OAAOC,IAAP,MAAiB,MAAjB;;AAEA,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,GAAtB,EAA2B;AACzB,WAASC,iBAAT,GAA6B;AAC3B,WAAOJ,IAAI,CAACK,IAAL,CAAUC,OAAO,CAACC,GAAR,EAAV,EAAyB,MAAzB,EAAiC,eAAjC,CAAP;AACD;;AAED,WAASC,eAAT,CAAyBC,QAAzB,EAAmC;AACjC,UAAMC,QAAQ,GAAGX,EAAE,CAACY,YAAH,CAAgBF,QAAhB,CAAjB;AACA,UAAMG,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWJ,QAAX,CAAb;AAEA,WAAOE,IAAP;AACD;;AACD,MAAIV,GAAG,CAACa,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMC,IAAI,GAAGd,GAAG,CAACe,IAAJ,CAASD,IAAtB;AACA,UAAME,KAAK,GAAGhB,GAAG,CAACe,IAAJ,CAASC,KAAvB;AACA,UAAMC,YAAY,GAAGjB,GAAG,CAACe,IAAJ,CAASG,QAA9B;AAEA,UAAMC,WAAW,GAAG;AAClBC,MAAAA,EAAE,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EADc;AAElBR,MAAAA,IAAI,EAAEA,IAFY;AAGlBE,MAAAA,KAAK,EAAEA,KAHW;AAIlBE,MAAAA,QAAQ,EAAED;AAJQ,KAApB,CALyB,CAYzB;;AACA,UAAMV,QAAQ,GAAGL,iBAAiB,EAAlC;AACA,UAAMQ,IAAI,GAAGJ,eAAe,CAACC,QAAD,CAA5B;AACAG,IAAAA,IAAI,CAACa,IAAL,CAAUJ,WAAV;AACAtB,IAAAA,EAAE,CAAC2B,aAAH,CAAiBjB,QAAjB,EAA2BI,IAAI,CAACc,SAAL,CAAef,IAAf,CAA3B;AACAT,IAAAA,GAAG,CAACyB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE,OAAX;AAAoBV,MAAAA,QAAQ,EAAEC;AAA9B,KAArB;AACD,GAlBD,MAkBO;AACL;AACA,UAAMZ,QAAQ,GAAGL,iBAAiB,EAAlC;AACA,UAAMQ,IAAI,GAAGJ,eAAe,CAACC,QAAD,CAA5B;AACAN,IAAAA,GAAG,CAACyB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAET,MAAAA,QAAQ,EAAER;AAAZ,KAArB;AACD;AACF;;AAED,eAAeX,OAAf","sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\nfunction handler(req, res) {\n  function buildFeedbackPath() {\n    return path.join(process.cwd(), 'data', 'feedback.json')\n  }\n\n  function extractFeedback(filePath) {\n    const fileData = fs.readFileSync(filePath)\n    const data = JSON.parse(fileData)\n\n    return data\n  }\n  if (req.method === 'POST') {\n    const name = req.body.name\n    const email = req.body.email\n    const feedBackText = req.body.feedback\n\n    const newFeedback = {\n      id: new Date().toISOString(),\n      name: name,\n      email: email,\n      feedback: feedBackText,\n    }\n\n    //数据存储在数据库或者文件当中\n    const filePath = buildFeedbackPath()\n    const data = extractFeedback(filePath)\n    data.push(newFeedback)\n    fs.writeFileSync(filePath, JSON.stringify(data))\n    res.status(201).json({ message: '保存成功！', feedback: newFeedback })\n  } else {\n    //get请求\n    const filePath = buildFeedbackPath()\n    const data = extractFeedback(filePath)\n    res.status(200).json({ feedback: data })\n  }\n}\n\nexport default handler\n"]},"metadata":{},"sourceType":"module"}